{"version":3,"kind":"Notebook","sha256":"52872a661a31d1de21e039e5b5bdceedf915b1a9bc1473d61aaf438b02ecfa86","slug":"workshop-files.eda-workshop","location":"/workshop_files/eda_workshop.ipynb","dependencies":[],"frontmatter":{"title":"Workshop - Exploratory Data Analysis","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"chem502","language":"python"},"authors":[{"id":"Sam Chong","name":"Sam Chong"},{"id":"Joe Forth","name":"Joe Forth"}],"github":"https://github.com/joeforth/chem502_book","numbering":{"title":{"offset":1}},"exports":[{"format":"ipynb","filename":"eda_workshop.ipynb","url":"/eda_workshop-68607ca8e99991f3284c4ecff1139408.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this workshop, we will work with a dataset of thermochemical data for some molecules to explore what features or descriptors are influential in their melting and/or boiling points.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jXPgMarXRn"}],"key":"qxKtfO8Iqy"}],"key":"friJ43Sg1e"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Useful resources","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mslm1U0fY3"}],"identifier":"useful-resources","label":"Useful resources","html_id":"useful-resources","implicit":true,"key":"dskNjr4vRs"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We will be using some of the python libraries you have already seen and Seaborn, which you might not have yet. Here are some quick start guides and/or tutorials that might come in useful.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"r2wsPqKrZz"}],"key":"K3FNMR5vdj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Pandas","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Ok94AwCgKf"}],"key":"BjfmH04v5v"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://pandas.pydata.org/docs/user_guide/10min.html","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"10 minutes to pandas","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"rOl5ISjP1t"}],"urlSource":"https://pandas.pydata.org/docs/user_guide/10min.html","key":"X2fMCzrcnT"}],"key":"FC1eKWtusO"}],"key":"oybuBusHs1"}],"key":"Dz5TXmirvd"}],"key":"rv6BM0iCo5"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Matplotlib","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CO6wPui5qZ"}],"key":"p8h3feqPdo"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://matplotlib.org/stable/users/explain/quick_start.html","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Quick start guide","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"McJvm2JVcr"}],"urlSource":"https://matplotlib.org/stable/users/explain/quick_start.html","key":"ArBoytqs6U"}],"key":"oTzNuZnxd7"}],"key":"Dc6neqsLIp"}],"key":"xbrjAbqNVw"}],"key":"eJBwkJZC0G"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"RDKit","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"MSOtjEsG2H"}],"key":"CxDuQ71XIu"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://www.rdkit.org/docs/GettingStartedInPython.html","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Getting started with the RDKit in Python","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"KWRq0eLNYr"}],"urlSource":"https://www.rdkit.org/docs/GettingStartedInPython.html","key":"W5IH930zu0"}],"key":"Wviid3H1KJ"}],"key":"GM5VhBtv9x"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://github.com/greglandrum/AIDD_RDKit_Tutorial_2021/blob/b4c4661ff7980721823654f54cd0c28031c5884c/RDKit_Intro.ipynb","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"RDKit tutorial from 2021","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"rUk11C4THH"}],"urlSource":"https://github.com/greglandrum/AIDD_RDKit_Tutorial_2021/blob/b4c4661ff7980721823654f54cd0c28031c5884c/RDKit_Intro.ipynb","data":{"kind":"file","org":"greglandrum","repo":"AIDD_RDKit_Tutorial_2021","reference":"b4c4661ff7980721823654f54cd0c28031c5884c","file":"RDKit_Intro.ipynb","raw":"https://raw.githubusercontent.com/greglandrum/AIDD_RDKit_Tutorial_2021/b4c4661ff7980721823654f54cd0c28031c5884c/RDKit_Intro.ipynb"},"internal":false,"protocol":"github","key":"iV5hh1At1D"},{"type":"text","value":" - this covers a lot of ground. We won’t be talking about reactions (towards end of notebook)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"BJng0kdgc1"}],"key":"IURDqiRFN0"}],"key":"DUcJ16deg6"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"There are also lots of videos on YouTube and of course ChatGPT (though I am not sure how well it does with RDKit, probably because the documentation is patchy).","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"hdSVlwtwBK"}],"key":"uL3Taegpme"}],"key":"Ticvc7DhHw"}],"key":"SgFsqxmZHF"}],"key":"UOintRLcCT"}],"key":"nKFXVbkUn4"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"You might also find some useful bits and pieces in the ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ZZRUaQQy1S"},{"type":"link","url":"https://drsamchong.github.io/c3d-book/1-chem_data/fingerprints.html","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Molecular fingerprints notebook","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Kv39A8SI4G"}],"urlSource":"https://drsamchong.github.io/c3d-book/1-chem_data/fingerprints.html","key":"CIt6PyUvei"},{"type":"text","value":" in the module book.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"vdp8vf2svz"}],"key":"WLAuFakZLQ"}],"key":"GozBpW7PLX"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"HbitQEUqxz"}],"key":"K4xXvThhL4"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"You can find a notebook with code for the data cleaning, visualisation of the initial data and calculation of molecular descriptors ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"nTWN9B4ygd"},{"type":"link","url":"/eda_workshop_complet-1705382b014dd98e8a4b4596021f5293.ipynb","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"VnD7YOfhQO"}],"urlSource":"eda_workshop_complete","static":true,"protocol":"file","key":"mjgrruTPAu"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Vt34UfnGzD"}],"key":"ziMAuIQirI"}],"key":"TYqKMkVu5Z"}],"key":"KscP1kP78D"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualising factors affecting thermochemical properties ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"E7UV4ndJdU"},{"type":"break","key":"f2ObIDBoSf"},{"type":"text","value":" of organic compounds","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F5OXrhEyLE"}],"identifier":"visualising-factors-affecting-thermochemical-properties-of-organic-compounds","label":"Visualising factors affecting thermochemical properties  of organic compounds","html_id":"visualising-factors-affecting-thermochemical-properties-of-organic-compounds","implicit":true,"key":"JrSGCUMRar"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s start by importing some libraries:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fyGWpH7N03"}],"key":"D5itGortfm"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"time (needed to include a sleep)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mtKEoMt2Eh"}],"key":"QTYnEoNPgz"}],"key":"h2exLoTbvy"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"requests","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"BgZd67w7IQ"}],"key":"prFjUZMND5"}],"key":"w7YisYVcWz"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"pandas","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"OgqzBOlFtp"}],"key":"gYkEKFI7yU"}],"key":"IdUbvkgRqD"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"numpy","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"tHrwmgY5Tg"}],"key":"lMEIISZAQi"}],"key":"Kujx70I9Xj"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"matplotlib","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"A7oU2OLiWV"}],"key":"zLrrGNMz2l"}],"key":"PMvtaZst90"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"seaborn","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"IhvMyXOBgh"}],"key":"qxigDbm3VE"}],"key":"brt1OlJAyA"}],"key":"CmEbpWz1Fy"}],"key":"gIB8QX1iU0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# TODO: Write your import statements here.\n\n\n# rdkit has a complicated structure, so we will start with these and maybe add some later\n\nfrom rdkit import Chem\nfrom rdkit.Chem import (\n                        AllChem,\n                        rdCoordGen,\n                        Draw,\n                        rdFingerprintGenerator,\n                        PandasTools,\n                        Descriptors\n                        )\n\nfrom rdkit.Chem.Draw import IPythonConsole\nfrom rdkit import DataStructs\n\nfrom IPython.display import SVG\nfrom ipywidgets import interact,fixed,IntSlider","key":"Hqsx6IzNdw"},{"type":"outputs","id":"aiD1EBOusQkpDcg-5r_Xe","children":[],"key":"pzdAvQyC1u"}],"key":"dkYGFv285s"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Loading the data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yB3qiJ0yL7"}],"identifier":"loading-the-data","label":"Loading the data","html_id":"loading-the-data","implicit":true,"key":"Ob1UhBcswL"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The data is stored in a flat csv file in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uJdBGBkgm8"},{"type":"inlineCode","value":"data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"w6pe8hgOIS"},{"type":"text","value":" directory called ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t56aOadH1k"},{"type":"inlineCode","value":"alcohol_acid_phys_data.csv","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"e9BMOpgME9"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IMyz2LPSBq"}],"key":"zqIQN6hUxM"},{"type":"list","ordered":true,"start":0,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Check the data in the file (try the ‘head’ command)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"E02qkKxcZU"}],"key":"GpGlPshZaO"}],"key":"cXxsA1jSFt"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Read the data into a pandas dataframe","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Wfrh2bmU86"}],"key":"qUcHfQMoiG"}],"key":"sEkQIGSFIc"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Display the dataframe","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hkguA0BCvQ"}],"key":"FrmIeIa6Bc"}],"key":"lhqGbTUuTG"}],"key":"EBaAbeo1II"}],"key":"jnY5cgceuo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# TODO:\n\n# 0. Check the data in the file (try the 'head' command)\n# 1. Read the data into a pandas dataframe\n# 2. Display the dataframe\n\n","key":"Acsl5AIHJ2"},{"type":"outputs","id":"ejUkucg5_HmfGnTMqHQYe","children":[],"key":"qrX2AU4cxu"}],"key":"m5pPjZ6O0Z"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cleaning the data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MqoJvPaiCI"}],"identifier":"cleaning-the-data","label":"Cleaning the data","html_id":"cleaning-the-data","implicit":true,"key":"QFnwMvrKo8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We need to do at least a little cleaning of the data. We can check the data for the number of rows and the data types in each column using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cGQwbmXlzp"},{"type":"link","url":"https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.info.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"DataFrame.info()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"k9emLeT6LD"}],"urlSource":"https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.info.html","key":"c8i16CzVAX"},{"type":"text","value":" method.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"x5bopei2cb"}],"key":"URiaeDGLh7"}],"key":"NZndyd1ZeO"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"There are lots of pKa values missing. We are not going to use the pKa values, so we can drop those columns.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Kg3H65BY8w"}],"key":"WfrbFr1afi"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Some rows are missing densities. And more importantly, some are missing melting and/or boiling points, which is the property we are interested in.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sttNPOsZWL"}],"key":"DQn5PnnBE2"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"It might be possible to look these up somewhere, like the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"u1JBMsqbDq"},{"type":"link","url":"https://webbook.nist.gov/chemistry/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"NIST Chemistry WebBook","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ch7VjzrK16"}],"urlSource":"https://webbook.nist.gov/chemistry/","key":"p05dItV2QJ"},{"type":"text","value":" which unfortunately does seem not have a convenient API (there are unofficial ones if you search on the web). For now we can also drop these rows.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GgDx2BmvzJ"}],"key":"PeYj5CBgM7"}],"key":"ZiqEM2NQ57"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# TODO:\n# 1. Drop the two pKa columns\n# 2. Drop the rows with NaN values in density, melting point and boiling point columns.\n# 3. Check the info again to see if the changes have been made.\n\n","key":"weYircmdGO"},{"type":"outputs","id":"Hndu_sStaqw0dkO8qVUca","children":[],"key":"XkZy3Upfh1"}],"key":"b6bdPVPsRl"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Still a few issues:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TOwTdp0D3J"}],"key":"Eq95EVzfKU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SFd9pR432S"},{"type":"inlineCode","value":"Class","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UGWcBrnilQ"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"saixYaViVY"},{"type":"inlineCode","value":"IUPAC name","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DryU6AkcS0"},{"type":"text","value":" columns have some odd characters which appear to encode whitespace, e.g. Alkanedioic\\r\\nacid.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FClxZZX8hj"}],"key":"q3Ji6OdPvu"}],"key":"dv0FXsVtfE"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The .info() shows that the melting and boiling points have object, i.e. string data types, which suggests there are non-numerical values. If you look at the columns, some numbers have “d” or “s” sometimes with a number, probably to denote “decomposed” or “sublimed” maybe.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Rd5GaiLpUC"}],"key":"B7D5c3fDVh"}],"key":"wXzG9d9zJo"}],"key":"VoO9P5ChyV"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Pandas has ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"cpma7H6imY"},{"type":"inlineCode","value":"str.contains","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"an8o0BoLj0"},{"type":"text","value":" and ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Djy0QT2iov"},{"type":"inlineCode","value":"str.replace","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"hymufyXjVe"},{"type":"text","value":" methods for its ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"rRuZSr6HYJ"},{"type":"inlineCode","value":"Series","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"xe7wPf9IBN"},{"type":"text","value":" structure. Try using these to check and remove the encoded characters in those columns.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"xN0Rojipwl"}],"key":"sRgiJEkIy4"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Can you think of a way to deal with the non- or partly numeric phase change values?","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"te8BYO9vBp"}],"key":"putoBAUrd5"},{"type":"admonition","kind":"hint","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Hint","key":"cV3J8wC0Fi"}],"key":"AiLhFyOamW"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Could ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"o5hSl1y8CQ"},{"type":"link","url":"https://pandas.pydata.org/docs/reference/api/pandas.to_numeric.html","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"this","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"oVa7uhleWz"}],"urlSource":"https://pandas.pydata.org/docs/reference/api/pandas.to_numeric.html","key":"fFv9F8waQR"},{"type":"text","value":" help?","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"dMnTHF4joy"}],"key":"rkCfPRHbgj"}],"key":"O0pUChcPW3"}],"key":"jVA746J0u0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# TODO:\n\n# 1. Ensure only numeric values are present in the melting point, boiling point columns\n# 2. Remove the encoded whitespace characters from the 'Class' and 'IUPAC name' columns\n# 3. Convert the melting point, boiling point columns to numeric values.","key":"nHCRrDilBS"},{"type":"outputs","id":"HmbEjNrq7s3VV_eYuYSEL","children":[],"key":"fQRGWmV0nL"}],"key":"icXxVXvFLh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Some of the compounds do not have common names. We could either drop the column or fill the missing values with something like “unknown” or “none”.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UG97KWrBWy"}],"key":"i3PjsgT8eJ"}],"key":"NO3VjiHXD6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# TODO:\n\n# Clean column with missing compounds' common names\n","key":"OnZru4Wbsj"},{"type":"outputs","id":"U17xy6EM4YLxjM3zroeGF","children":[],"key":"e5rE4zE3vA"}],"key":"l8XR9KG7H2"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If you converted the mp and bp columns to numeric types using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xj4j5LYXyE"},{"type":"inlineCode","value":"pd.to_numeric","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mOw8ofi0Ek"},{"type":"text","value":" with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ilcupjlcg6"},{"type":"inlineCode","value":"errors=\"coerce\"","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YKMkaAQMPp"},{"type":"text","value":" then you will probably now have some additional null values in those columns, so those rows can be dropped.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ui9aKqMuuq"}],"key":"ymu6SBIYiu"}],"key":"Z8Cd0yuBzz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# TODO: Drop any remaining rows with NaN values in mp/bp columns\n","key":"RROdBL1Z6S"},{"type":"outputs","id":"YujwxP8pCozwifxHtl1J4","children":[],"key":"wHyetDySrA"}],"key":"K72SAYE3Q8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Finally, we have a clean dataset with no missing values and the correct dtypes.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lKceYiRjhg"}],"key":"hxIzFjlewN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We can look at the summary statistics for the numerical columns we currently have, but there’s not much there yet.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WxSMNszUC7"}],"key":"XM3a403OYz"}],"key":"ZWrxDS8eCe"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"There is one more thing we can do to tidy this data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fr1CiADPHM"}],"key":"O7MTEcKupx"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"You may not be so familiar with the pandas ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yklTPkuZzl"},{"type":"inlineCode","value":"category","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hslpAYv8I6"},{"type":"text","value":" dtype. It is used when a variable takes a limited number of values.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fVnTjFm11g"}],"key":"L7gjWYnjWb"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Check the number of unique values for the columns. Which one could be treated as categorical data?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"x2lIKbSGU3"}],"key":"skgXlBlj8D"}],"key":"ko3ilRK4AU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# TODO: Check for categorical columns and change the data type to 'category' if necessary\n\n","key":"ySio7bQ5nk"},{"type":"outputs","id":"7DZ-pzZipYftpEnWN8Xks","children":[],"key":"tLFMz8k1QN"}],"key":"iXMuifeiao"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualising the data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M5XgNj8OZc"}],"identifier":"visualising-the-data","label":"Visualising the data","html_id":"visualising-the-data","implicit":true,"key":"hrjgfC4Q8s"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Have a look at this brilliant ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cVCFLLGBOS"},{"type":"link","url":"https://weisscharlesj.github.io/SciCompforChemists/notebooks/chapter_10/chap_10_notebook.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"seaborn tutorial","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wwGlYJtZdV"}],"urlSource":"https://weisscharlesj.github.io/SciCompforChemists/notebooks/chapter_10/chap_10_notebook.html","key":"jKUr46ZoFd"},{"type":"text","value":" developed as by Charles J. Weiss at Augustana University in South Dakota.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lfj7xAzAlk"}],"key":"GRFT94jVGI"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Some of the data used has a similar structure to this dataset.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ehuHT7DjOb"}],"key":"ExaA6MZGW6"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"There are no hard and fast rules about which types of plots to use to visualise your data, but the data types of the columns will mean some are more suitable to look at the data and relationships for certain variables.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"dZcA7fkN0j"}],"key":"TyKhkUEyoC"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Try plotting the data to visualise some of the following:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"IylJ69d3D6"}],"key":"WeSBOrNfEY"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The distribution of different classes of compound in the data set","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"xPH8x1RyD9"}],"key":"BnQfnew28e"}],"key":"vTBgqja0kw"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Identify if there are any outliers for the thermochemical data or density","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"HL50DL1vpX"}],"key":"EqJ3mh462q"}],"key":"Qc5a2UDrAo"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The distribution of boiling points, melting point and/or density with the class of the compound","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"FXCAjxJj9Z"}],"key":"bgDe5gi0yn"}],"key":"gLk7H8XI8w"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Identify any correlations between the numerical features and the melting and/or boiling point.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"L91UcrBDoG"}],"key":"WqFwjKhFEN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Is there any difference for different classes of compound?","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"cFFUMAEhEr"}],"key":"Iqh4dFmrAx"}],"key":"O1giCXVQb1"}],"key":"RujlGEj5HO"}],"key":"E0JCBaSCxw"}],"key":"nI7piT3vAD"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Are there any other interesting patterns or trends in the data that you have observed?","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"t1icEY6TI8"}],"key":"VddgTrv0CX"}],"key":"V3NxCeKCHz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Adding some descriptors","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zzo7xumARK"}],"identifier":"adding-some-descriptors","label":"Adding some descriptors","html_id":"adding-some-descriptors","implicit":true,"key":"taU7ht85AT"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We have a list of compounds and a small number of observed values and descriptors. We can add a few more by calculating them using RDKit, but we only have IUPAC names, so we need to obtain a more rigorous representation to use with RDKit.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Eb4hniagNw"}],"key":"yKxuTBET56"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PolKdjHNhu"},{"type":"link","url":"https://cactus.nci.nih.gov/chemical/structure","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Chemical Identifier Resolver","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"abcnkgu8q7"}],"urlSource":"https://cactus.nci.nih.gov/chemical/structure","key":"RO6KJdt1C6"},{"type":"text","value":" (CIR) service is run by the CADD Group at the NCI/NIH as part of their ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WlUrOrOnN4"},{"type":"link","url":"https://cactus.nci.nih.gov","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Cactus server","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"aDISLwwdRa"}],"urlSource":"https://cactus.nci.nih.gov","key":"oDpISa7t6I"},{"type":"text","value":". It is used in the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sHHp6YFqhW"},{"type":"link","url":"https://drsamchong.github.io/c3d-book/1-chem_data/fingerprints.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Molecular fingerprints notebook","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"V2EkF4Wtwz"}],"urlSource":"https://drsamchong.github.io/c3d-book/1-chem_data/fingerprints.html","key":"HDaBuGEgEy"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"quKWl8Rgm7"}],"key":"PkYN4VUGZi"}],"key":"dZK4YvocdH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Here is a function so the process of getting the SMILES can be repeated for multiple compounds.\n# It includes a sleep time (`time.sleep`) to avoid overloading the server.\n\ndef get_smiles_from_name(name):\n    \"\"\"Gets SMILES string from the Cactus API given a chemical name.\"\"\"\n    \n    ROOT_URL = \"https://cactus.nci.nih.gov/chemical/structure/\"\n    identifier = name\n    representation = \"smiles\"\n\n    query_url = f\"{ROOT_URL}{identifier}/{representation}\"\n\n    response = requests.get(query_url)\n    time.sleep(0.05)\n    if response:\n        return response.text\n    else:\n        print(f\"Failed to get SMILES for {name}\")\n        return \"not found\"\n        # raise Exception(f\"Cactus request failed for {name}: {response.status_code}\")\n","key":"EL2LbdrltO"},{"type":"outputs","id":"muo2VahJirP7F7mrTc0ZD","children":[],"key":"yVYV2TIZbA"}],"key":"xLEJsYHv7p"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# TODO: Get a list of SMILES strings for the compounds in the dataframe and add this to the \n# dataframe as a new column.\n\n","key":"JRxWRtVqtE"},{"type":"outputs","id":"kiLJDURU5VKKWhNmg7Wgz","children":[],"key":"dHCIqamKfi"}],"key":"Xa22I1f0E4"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s generate some descriptors for these molecules using RDKit.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M3GxnHEFCK"}],"key":"RnuVO3aNNQ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"There is a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ziYq7OFjn9"},{"type":"link","url":"https://greglandrum.github.io/rdkit-blog/posts/2022-12-23-descriptor-tutorial.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"tutorial","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EhSm1IihFr"}],"urlSource":"https://greglandrum.github.io/rdkit-blog/posts/2022-12-23-descriptor-tutorial.html","key":"aDNSDCGNdv"},{"type":"text","value":" on calculating descriptors, and they are listed in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DT0IwtaKkC"},{"type":"link","url":"https://www.rdkit.org/docs/GettingStartedInPython.html#list-of-available-descriptors","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Getting Started guide","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xSBwQxAdwf"}],"urlSource":"https://www.rdkit.org/docs/GettingStartedInPython.html#list-of-available-descriptors","key":"fUzUzxIXI7"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"o4u5nIBWFY"}],"key":"buoUOYfDAJ"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"RDKit needs a ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hHg6dk29wN"},{"type":"inlineCode","value":"RDKit.molecule","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"s2PnKPQ2KJ"},{"type":"text","value":" to calculate the descriptors. You can create a separate list of molecules based on the SMILES strings in the dataframe, or you can use RDKit’s ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"aDg324ir7W"},{"type":"link","url":"https://www.rdkit.org/docs/source/rdkit.Chem.PandasTools.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"PandasTools module","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pSNxrZ0u0B"}],"urlSource":"https://www.rdkit.org/docs/source/rdkit.Chem.PandasTools.html","key":"K9x1doquAJ"},{"type":"text","value":" to work with them in a DataFrame.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eaF6ATGUo4"}],"key":"HtxNyORZhg"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Have a look at the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"SGiO7nGJMy"},{"type":"link","url":"https://drsamchong.github.io/c3d-book/1-chem_data/fingerprints.html","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"molecular fingerprints notebook","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Z9Ui8a9dEc"}],"urlSource":"https://drsamchong.github.io/c3d-book/1-chem_data/fingerprints.html","key":"FgA9BsxaDv"},{"type":"text","value":" for some code to get started getting the RDKit molecules.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gx2aDUbiGx"}],"key":"C5sVnq07hx"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Choose around 5 additional descriptors to calculate for each compound.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"dU4WvEf61F"}],"key":"gxKWEsLUnK"}],"key":"bPZ6v7aZTZ"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"It is up to you how you handle the calculations and getting the new data combined with the existing dataframe.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"OMoQuTlSLW"}],"key":"XuB3qzM3Uu"}],"key":"GOpjGvZy6I"}],"key":"v0EDBjcijT"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Here is one option:","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"EzJGGDnwBy"}],"key":"UOTNN55Qbj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"You could use the getMolDescriptors function in the ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"TiKuYPajvM"},{"type":"link","url":"https://greglandrum.github.io/rdkit-blog/posts/2022-12-23-descriptor-tutorial.html","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"descriptors tutorial","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"QUEPTINu75"}],"urlSource":"https://greglandrum.github.io/rdkit-blog/posts/2022-12-23-descriptor-tutorial.html","key":"A2nwsuIxLf"},{"type":"text","value":" as starting point to calculate the new descriptors and add them to dictionary that can be read into a dataframe.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"r0o27IowzL"}],"key":"EdZsxOp1yP"}],"key":"jwEneVDr5n"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"You can then use ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"WfDBJVaMt4"},{"type":"link","url":"https://pandas.pydata.org/docs/reference/api/pandas.concat.html","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"inlineCode","value":"pd.concat","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ZFaTJDhzB7"}],"urlSource":"https://pandas.pydata.org/docs/reference/api/pandas.concat.html","key":"vTYdqmUY3H"},{"type":"text","value":" to combine the dataframe with your thermochemical data with the new descriptors.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"G2kCFvVMk8"}],"key":"qzOvr96oDY"}],"key":"RSYNg91z2z"}],"key":"wcQwE5ZD4k"}],"key":"CWAXXjvxn9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Add RDKit molecule objects to the dataframe\n","key":"rOtKb7k7uf"},{"type":"outputs","id":"xlaKLxPmLD2TxYwWKxYhY","children":[],"key":"dZUl9N02rX"}],"key":"vgGhjhW93V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for idx, desc in enumerate(Descriptors.descList):\n    print(f\"{idx} {desc[0]}\")","key":"xcXycqtCuM"},{"type":"outputs","id":"vKABer_KWmf1KCqAoZsGA","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"0 MaxAbsEStateIndex\n1 MaxEStateIndex\n2 MinAbsEStateIndex\n3 MinEStateIndex\n4 qed\n5 SPS\n6 MolWt\n7 HeavyAtomMolWt\n8 ExactMolWt\n9 NumValenceElectrons\n10 NumRadicalElectrons\n11 MaxPartialCharge\n12 MinPartialCharge\n13 MaxAbsPartialCharge\n14 MinAbsPartialCharge\n15 FpDensityMorgan1\n16 FpDensityMorgan2\n17 FpDensityMorgan3\n18 BCUT2D_MWHI\n19 BCUT2D_MWLOW\n20 BCUT2D_CHGHI\n21 BCUT2D_CHGLO\n22 BCUT2D_LOGPHI\n23 BCUT2D_LOGPLOW\n24 BCUT2D_MRHI\n25 BCUT2D_MRLOW\n26 AvgIpc\n27 BalabanJ\n28 BertzCT\n29 Chi0\n30 Chi0n\n31 Chi0v\n32 Chi1\n33 Chi1n\n34 Chi1v\n35 Chi2n\n36 Chi2v\n37 Chi3n\n38 Chi3v\n39 Chi4n\n40 Chi4v\n41 HallKierAlpha\n42 Ipc\n43 Kappa1\n44 Kappa2\n45 Kappa3\n46 LabuteASA\n47 PEOE_VSA1\n48 PEOE_VSA10\n49 PEOE_VSA11\n50 PEOE_VSA12\n51 PEOE_VSA13\n52 PEOE_VSA14\n53 PEOE_VSA2\n54 PEOE_VSA3\n55 PEOE_VSA4\n56 PEOE_VSA5\n57 PEOE_VSA6\n58 PEOE_VSA7\n59 PEOE_VSA8\n60 PEOE_VSA9\n61 SMR_VSA1\n62 SMR_VSA10\n63 SMR_VSA2\n64 SMR_VSA3\n65 SMR_VSA4\n66 SMR_VSA5\n67 SMR_VSA6\n68 SMR_VSA7\n69 SMR_VSA8\n70 SMR_VSA9\n71 SlogP_VSA1\n72 SlogP_VSA10\n73 SlogP_VSA11\n74 SlogP_VSA12\n75 SlogP_VSA2\n76 SlogP_VSA3\n77 SlogP_VSA4\n78 SlogP_VSA5\n79 SlogP_VSA6\n80 SlogP_VSA7\n81 SlogP_VSA8\n82 SlogP_VSA9\n83 TPSA\n84 EState_VSA1\n85 EState_VSA10\n86 EState_VSA11\n87 EState_VSA2\n88 EState_VSA3\n89 EState_VSA4\n90 EState_VSA5\n91 EState_VSA6\n92 EState_VSA7\n93 EState_VSA8\n94 EState_VSA9\n95 VSA_EState1\n96 VSA_EState10\n97 VSA_EState2\n98 VSA_EState3\n99 VSA_EState4\n100 VSA_EState5\n101 VSA_EState6\n102 VSA_EState7\n103 VSA_EState8\n104 VSA_EState9\n105 FractionCSP3\n106 HeavyAtomCount\n107 NHOHCount\n108 NOCount\n109 NumAliphaticCarbocycles\n110 NumAliphaticHeterocycles\n111 NumAliphaticRings\n112 NumAmideBonds\n113 NumAromaticCarbocycles\n114 NumAromaticHeterocycles\n115 NumAromaticRings\n116 NumAtomStereoCenters\n117 NumBridgeheadAtoms\n118 NumHAcceptors\n119 NumHDonors\n120 NumHeteroatoms\n121 NumHeterocycles\n122 NumRotatableBonds\n123 NumSaturatedCarbocycles\n124 NumSaturatedHeterocycles\n125 NumSaturatedRings\n126 NumSpiroAtoms\n127 NumUnspecifiedAtomStereoCenters\n128 Phi\n129 RingCount\n130 MolLogP\n131 MolMR\n132 fr_Al_COO\n133 fr_Al_OH\n134 fr_Al_OH_noTert\n135 fr_ArN\n136 fr_Ar_COO\n137 fr_Ar_N\n138 fr_Ar_NH\n139 fr_Ar_OH\n140 fr_COO\n141 fr_COO2\n142 fr_C_O\n143 fr_C_O_noCOO\n144 fr_C_S\n145 fr_HOCCN\n146 fr_Imine\n147 fr_NH0\n148 fr_NH1\n149 fr_NH2\n150 fr_N_O\n151 fr_Ndealkylation1\n152 fr_Ndealkylation2\n153 fr_Nhpyrrole\n154 fr_SH\n155 fr_aldehyde\n156 fr_alkyl_carbamate\n157 fr_alkyl_halide\n158 fr_allylic_oxid\n159 fr_amide\n160 fr_amidine\n161 fr_aniline\n162 fr_aryl_methyl\n163 fr_azide\n164 fr_azo\n165 fr_barbitur\n166 fr_benzene\n167 fr_benzodiazepine\n168 fr_bicyclic\n169 fr_diazo\n170 fr_dihydropyridine\n171 fr_epoxide\n172 fr_ester\n173 fr_ether\n174 fr_furan\n175 fr_guanido\n176 fr_halogen\n177 fr_hdrzine\n178 fr_hdrzone\n179 fr_imidazole\n180 fr_imide\n181 fr_isocyan\n182 fr_isothiocyan\n183 fr_ketone\n184 fr_ketone_Topliss\n185 fr_lactam\n186 fr_lactone\n187 fr_methoxy\n188 fr_morpholine\n189 fr_nitrile\n190 fr_nitro\n191 fr_nitro_arom\n192 fr_nitro_arom_nonortho\n193 fr_nitroso\n194 fr_oxazole\n195 fr_oxime\n196 fr_para_hydroxylation\n197 fr_phenol\n198 fr_phenol_noOrthoHbond\n199 fr_phos_acid\n200 fr_phos_ester\n201 fr_piperdine\n202 fr_piperzine\n203 fr_priamide\n204 fr_prisulfonamd\n205 fr_pyridine\n206 fr_quatN\n207 fr_sulfide\n208 fr_sulfonamd\n209 fr_sulfone\n210 fr_term_acetylene\n211 fr_tetrazole\n212 fr_thiazole\n213 fr_thiocyan\n214 fr_thiophene\n215 fr_unbrch_alkane\n216 fr_urea\n"},"children":[],"key":"KqVHoPu2N6"}],"key":"kq4c2FyPaf"}],"key":"PfTcOrmL6G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# From https://greglandrum.github.io/rdkit-blog/posts/2022-12-23-descriptor-tutorial.html\n\ndef getMolDescriptors(mol, descriptor_list=None, missingVal=None):\n    ''' calculate the full list of descriptors for a molecule\n    \n        missingVal is used if the descriptor cannot be calculated\n    '''\n    res = {}\n    if descriptor_list is None:\n        for nm,fn in Descriptors._descList:\n            # some of the descriptor fucntions can throw errors if they fail, catch those here:\n            try:\n                val = fn(mol)\n            except:\n                # print the error message:\n                import traceback\n                traceback.print_exc()\n                # and set the descriptor value to whatever missingVal is\n                val = missingVal\n            res[nm] = val\n    # TODO: Add else clause to handle a list numbers corresponding to the descriptor indices\n    else:\n        pass\n    return res","key":"ROvRw4wGLZ"},{"type":"outputs","id":"QzJnB_EpHkBn-wKoqn0AO","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[('MaxAbsEStateIndex', <function MaxAbsEStateIndex at 0x315720720>), ('MaxEStateIndex', <function MaxEStateIndex at 0x3157205e0>), ('MinAbsEStateIndex', <function MinAbsEStateIndex at 0x3157207c0>), ('MinEStateIndex', <function MinEStateIndex at 0x315720680>), ('qed', <function qed at 0x315723920>)]\n"},"children":[],"key":"ZJWETproJ5"}],"key":"PZuqHFsTYl"}],"key":"pxOGGPDi7Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# TODO: Add the descriptors to the dataframe as new columns\n\n","key":"DYd2EVRkWt"},{"type":"outputs","id":"OueBNBU_s5qX69p9DKTyl","children":[],"key":"suyj9Gse6o"}],"key":"PsUjyK21SE"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Back to visualisation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"e09JpFRSpl"}],"identifier":"back-to-visualisation","label":"Back to visualisation","html_id":"back-to-visualisation","implicit":true,"key":"VaqkTTpzS5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Using your new seaborn skills, visualise the distributions and identify any correlations in your new data.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"z8SaA4l9vM"}],"key":"DdBrcn1uf0"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"You will probably find plots like pairplots or heatmaps of more use now that you have a few more variables.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BFN4ETx9ze"}],"key":"f9GGGGf9fi"}],"key":"XKbm7mkQ8D"},{"type":"block","kind":"notebook-content","children":[],"key":"SucOCh3kHK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YwdeqB6SL3"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"w03kpglFaP"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"You have used the pandas library to clean and prepare a dataset, and to get descriptive statistics for the data.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JTvghEoq1X"}],"key":"ZWhopaPIy6"}],"key":"xPZrJgk2Kv"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"You have visualised distributions and relationships in the data to look for anomalies and patterns.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BPcOZRLvUW"}],"key":"rPAwS7bqjQ"}],"key":"CvBwZnT2AF"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"You have used an API to obtain molecular identifiers/representations for a set of compounds.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"boN3SJJPMZ"}],"key":"oOSrvOcnFt"}],"key":"KVvGtxbjOk"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"You have generated molecular descriptors for a set of compounds using RDKit.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"jbwgeFg9BG"}],"key":"vDZiEqKdGg"}],"key":"FQRBuGI6AV"}],"key":"LShQKxEww3"}],"key":"l8XH3F7jnn"}],"key":"UCSIBg1XOC"},"references":{"cite":{"order":[],"data":{}}}}